# 配管揚程圧損計算ツール — ビジョン整理

## このツールで得られるメリット

### 1. 「Excel職人芸」からの脱却

配管の圧損計算は、多くの現場でExcelシートに属人的なマクロや関数が組まれ、担当者が変わるたびにブラックボックス化する。このツールでは**計算ロジックとパラメータの根拠をすべてリポジトリ上のデータソースとして管理**するため、誰でも計算根拠を追跡・検証・修正できる。

### 2. ルート変更時の再計算コストをゼロに近づける

従来は配管ルートが変わるたびに、エルボ・ティーの数え直し、直管長の再集計、高低差の拾い直しを手作業でやっていた。3Dルート入力とノード管理を統合することで、**ルートを引き直せば圧損が即座に再計算される**状態を作れる。

### 3. 「図面と計算書の乖離」をなくす

アイソメ・立面・平面の3ビューで配管ルートを確認しながら入力するため、計算に使ったルートと実際の設計図面の間に齟齬が生じにくい。計算書提出時に「この配管ルートで本当に計算したのか？」という疑義が出ない。

### 4. GitHub Pages公開による展開性

インストール不要・ブラウザだけで動く。協力会社や客先にURLを渡すだけで計算ツールを共有でき、社内サーバ運用の手間もない。データソースの更新はリポジトリへのPRで管理できるので、変更履歴も自然に残る。

---

## 開発ビジョン

### 最大のコンセプト

**「根拠が見える圧損計算」** — 計算結果だけでなく、使った摩擦係数・管粗度・局部損失係数・流体物性の出典と値がすべて追跡可能であること。

### アーキテクチャの方針

```
repository（データソース層）
├── fluid-properties/     … 流体物性（密度・粘度・蒸気圧 etc.）
├── pipe-specs/           … 配管仕様（内径・粗度・スケジュール別寸法）
├── fittings-db/          … 継手の局部損失係数（Cv値 / K値 / 等価長）
└── references/           … 出典情報（Crane TP-410, Moody線図 etc.）

ビルド時にこれらをバンドル → 静的サイトとしてデプロイ
```

計算パラメータをコードにハードコードせず、JSONデータファイルとして分離することで、「なぜこの係数なのか」をデータファイルのコミット履歴とリファレンス情報から誰でも確認できるようにする。

### 機能の構成（優先度の順）

| 優先度 | 機能 | 内容 |
|---|---|---|
| **P0** | 圧損計算エンジン | Darcy-Weisbach式、Colebrook-White式（Moody）、局部損失のK値法・Cv法 |
| **P0** | 配管ルート入力 | ノード座標(X,Y,Z)指定 → 自動でエルボ検出・直管長算出 |
| **P0** | 3ビュー表示 | アイソメ / 立面(Z-Y) / 平面(X-Y) の同期表示 |
| **P1** | 流体セレクタ | データソースから流体を選択、温度・圧力で物性を補間 |
| **P1** | 配管スペック選択 | NPS・スケジュール → 内径・粗度を自動取得 |
| **P2** | 計算書出力 | 計算過程をステップごとに表示、PDF/Markdown出力 |
| **P2** | ポンプ選定補助 | 全揚程＝実揚程＋摩擦損失＋局部損失 → ポンプカーブとの重ね描き |

### 技術選定の方向

- **フロントエンド**: React + Three.js（3Dビュー） or SVGベースの軽量2.5D描画
- **計算ロジック**: TypeScript（ブラウザ内で完結、サーバ不要）
- **データソース**: JSON → ビルド時にバンドル（Vite）
- **ホスティング**: GitHub Pages（静的サイト）
